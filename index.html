<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arepas La Troncal - Pedidos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #fdf8f1; font-family: sans-serif; }
        .brand-color { background-color: #5c3a21; }
        .accent-color { color: #5c3a21; }
        .card { border-radius: 15px; transition: transform 0.2s; }
        .card:active { transform: scale(0.98); }
    </style>
</head>
<body class="pb-10">

    <header class="brand-color text-white p-4 shadow-lg flex flex-col items-center">
        <img src="arepas-la-troncal.jpg" alt="Logo Arepas La Troncal" class="w-32 h-32 rounded-full border-4 border-amber-400 mb-2 shadow-md">
        <h1 class="text-xl font-bold uppercase tracking-widest">Arepas La Troncal</h1>
    </header>

    <main class="max-w-md mx-auto mt-6 px-4">
        
        <section id="productos" class="space-y-4">
            <h2 class="text-lg font-bold accent-color border-b-2 border-amber-200 pb-1">Haz tu pedido aqu√≠</h2>
            
            <div class="bg-white p-4 shadow-md card flex justify-between items-center border border-amber-100">
                <div class="flex-1">
                    <h3 class="font-bold text-gray-800">Arepa de Queso</h3>
                    <p class="text-xs text-gray-500 italic">Paquete x 5 unidades</p>
                    <p class="text-sm font-semibold accent-color mt-1">$<span class="precio">12000</span></p>
                </div>
                <div class="flex items-center space-x-3 bg-gray-50 p-2 rounded-lg">
                    <button onclick="cambiarCantidad(this, -1)" class="bg-gray-300 text-gray-700 w-8 h-8 rounded-full font-bold text-xl">-</button>
                    <span class="cantidad font-bold text-lg w-6 text-center">0</span>
                    <button onclick="cambiarCantidad(this, 1)" class="brand-color text-white w-8 h-8 rounded-full font-bold text-xl">+</button>
                </div>
            </div>

            <div class="bg-white p-4 shadow-md card flex justify-between items-center border border-amber-100">
                <div class="flex-1">
                    <h3 class="font-bold text-gray-800">Arepa de Ma√≠z</h3>
                    <p class="text-xs text-gray-500 italic">Paquete x 10 unidades</p>
                    <p class="text-sm font-semibold accent-color mt-1">$<span class="precio">8000</span></p>
                </div>
                <div class="flex items-center space-x-3 bg-gray-50 p-2 rounded-lg">
                    <button onclick="cambiarCantidad(this, -1)" class="bg-gray-300 text-gray-700 w-8 h-8 rounded-full font-bold text-xl">-</button>
                    <span class="cantidad font-bold text-lg w-6 text-center">0</span>
                    <button onclick="cambiarCantidad(this, 1)" class="brand-color text-white w-8 h-8 rounded-full font-bold text-xl">+</button>
                </div>
            </div>
        </section>

        <div class="mt-6 bg-amber-50 p-4 rounded-xl border border-amber-200 text-right">
            <p class="text-md font-medium text-gray-600">Subtotal: $<span id="subtotal">0</span></p>
            <p class="text-xl font-bold accent-color">TOTAL: $<span id="total-general">0</span></p>
        </div>

        <section class="mt-8 space-y-3">
            <h2 class="text-lg font-bold accent-color border-b-2 border-amber-200 pb-1">Datos de Env√≠o</h2>
            <input type="text" id="nombre" placeholder="Nombre completo" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-amber-500 outline-none">
            <input type="text" id="direccion" placeholder="Direcci√≥n de entrega" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-amber-500 outline-none">
            <input type="tel" id="telefono" placeholder="N√∫mero de Celular" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-amber-500 outline-none">
            
            <select id="pago" class="w-full p-3 border rounded-lg bg-white outline-none">
                <option value="Efectivo">Pagar con Efectivo</option>
                <option value="Nequi/Daviplata">Transferencia (Nequi/Daviplata)</option>
            </select>

            <textarea id="observaciones" rows="2" placeholder="Observaciones adicionales..." class="w-full p-3 border rounded-lg outline-none"></textarea>
        </section>

        <button onclick="enviarPedido()" class="mt-6 w-full bg-green-600 text-white font-bold py-4 rounded-xl shadow-lg hover:bg-green-700 flex justify-center items-center text-lg">
            Confirmar Pedido v√≠a WhatsApp
        </button>

        <footer class="mt-10 text-center text-gray-400 text-xs">
            <p>App desarrollada por <strong>Vibras Positivas</strong> ¬© Derechos de autor</p>
        </footer>

    </main>

    <script>
        function cambiarCantidad(btn, valor) {
            const contenedor = btn.parentElement;
            const spanCantidad = contenedor.querySelector('.cantidad');
            let actual = parseInt(spanCantidad.innerText);
            actual = Math.max(0, actual + valor);
            spanCantidad.innerText = actual;
            calcularTotal();
        }

        function calcularTotal() {
            let total = 0;
            document.querySelectorAll('#productos > div').forEach(producto => {
                const precio = parseInt(producto.querySelector('.precio').innerText);
                const cantidad = parseInt(producto.querySelector('.cantidad').innerText);
                total += precio * cantidad;
            });
            document.getElementById('subtotal').innerText = total.toLocaleString();
            document.getElementById('total-general').innerText = total.toLocaleString();
        }

        function enviarPedido() {
            const nombre = document.getElementById('nombre').value;
            const direccion = document.getElementById('direccion').value;
            const telefono = document.getElementById('telefono').value;
            const pago = document.getElementById('pago').value;
            const obs = document.getElementById('observaciones').value;
            const total = document.getElementById('total-general').innerText;

            if (!nombre || !direccion || !telefono) {
                alert("‚ö†Ô∏è Por favor completa tu nombre, direcci√≥n y celular.");
                return;
            }

            let productosTexto = "";
            document.querySelectorAll('#productos > div').forEach(prod => {
                const nombreP = prod.querySelector('h3').innerText;
                const cant = prod.querySelector('.cantidad').innerText;
                if (parseInt(cant) > 0) {
                    productosTexto += `- ${cant} x ${nombreP}%0A`;
                }
            });

            if (productosTexto === "") {
                alert("üõí Por favor agrega al menos un producto.");
                return;
            }

            // CONSTRUCCI√ìN DEL MENSAJE INCLUYENDO CR√âDITOS
            let mensaje = `*PEDIDO: AREPAS LA TRONCAL*%0A%0A`;
            mensaje += `*PRODUCTOS:*%0A${productosTexto}%0A`;
            mensaje += `*TOTAL A PAGAR:* $${total}%0A%0A`;
            mensaje += `*DATOS DEL CLIENTE:*%0A`;
            mensaje += `‚Ä¢ Nombre: ${nombre}%0A`;
            mensaje += `‚Ä¢ Direcci√≥n: ${direccion}%0A`;
            mensaje += `‚Ä¢ Celular: ${telefono}%0A`;
            mensaje += `‚Ä¢ Pago: ${pago}%0A`;
            mensaje += `‚Ä¢ Obs: ${obs}%0A%0A`;
            mensaje += `_App desarrollada por vibras positivas derecho de autor_`;

            const nroWhatsApp = "3122493344";
            window.open(`https://api.whatsapp.com/send?phone=${nroWhatsApp}&text=${mensaje}`, '_blank');
        }

        // Recuperar datos guardados (Control invisible)
        window.onload = () => {
            const guardado = localStorage.getItem('troncal_user');
            if (guardado) {
                const d = JSON.parse(guardado);
                document.getElementById('nombre').value = d.n || "";
                document.getElementById('direccion').value = d.d || "";
                document.getElementById('telefono').value = d.t || "";
            }
        }

        // Guardar datos autom√°ticamente
        document.addEventListener('input', () => {
            const d = {
                n: document.getElementById('nombre').value,
                d: document.getElementById('direccion').value,
                t: document.getElementById('telefono').value
            };
            localStorage.setItem('troncal_user', JSON.stringify(d));
        });
    </script>
</body>
</html>
